{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Alias/weboldal/web-login/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Alias/weboldal/web-login/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Alias/weboldal/web-login/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"C:/Users/Alias/weboldal/web-login/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import styles from'../styles/pages/Profile.module.css';import{useState}from'react';import{useOutletContext}from'react-router-dom';import Input from'../components/Input';import{gql,useMutation}from'@apollo/client';import{toast}from'react-hot-toast';import{ThemeProvider,createTheme}from'@mui/material/styles';import Avatar from'../components/Avatar';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var darkTheme=createTheme({palette:{mode:'dark'}});var UPDATE_USER_MUTATION=gql(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  mutation ($id: uuid!, $displayName: String!, $metadata: jsonb) {\\n    updateUser(pk_columns: { id: $id }, _set: { displayName: $displayName, metadata: $metadata, avatarUrl: $avatarUrl }) {\\n      id\\n      displayName\\n      metadata\\n      avatarUrl\\n    }\\n  }\\n\"])));var Profile=function Profile(){var _user$metadata$firstN,_user$metadata,_user$metadata$lastNa,_user$metadata2,_user$metadata3,_user$metadata4;var _useOutletContext=useOutletContext(),user=_useOutletContext.user;var _useState=useState((_user$metadata$firstN=user===null||user===void 0?void 0:(_user$metadata=user.metadata)===null||_user$metadata===void 0?void 0:_user$metadata.firstName)!==null&&_user$metadata$firstN!==void 0?_user$metadata$firstN:''),_useState2=_slicedToArray(_useState,2),firstName=_useState2[0],setFirstName=_useState2[1];var _useState3=useState((_user$metadata$lastNa=user===null||user===void 0?void 0:(_user$metadata2=user.metadata)===null||_user$metadata2===void 0?void 0:_user$metadata2.lastName)!==null&&_user$metadata$lastNa!==void 0?_user$metadata$lastNa:''),_useState4=_slicedToArray(_useState3,2),lastName=_useState4[0],setLastName=_useState4[1];var isFirstNameDirty=firstName!==(user===null||user===void 0?void 0:(_user$metadata3=user.metadata)===null||_user$metadata3===void 0?void 0:_user$metadata3.firstName);var isLastNameDirty=lastName!==(user===null||user===void 0?void 0:(_user$metadata4=user.metadata)===null||_user$metadata4===void 0?void 0:_user$metadata4.lastName);var isProfileFormDirty=isFirstNameDirty||isLastNameDirty;var _useMutation=useMutation(UPDATE_USER_MUTATION),_useMutation2=_slicedToArray(_useMutation,2),mutateUser=_useMutation2[0],updatingProfile=_useMutation2[1].loading;var updateUserProfile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return mutateUser({variables:{id:user.id,displayName:\"\".concat(firstName,\" \").concat(lastName).trim(),metadata:{firstName:firstName,lastName:lastName}}});case 4:toast.success('Updated successfully',{id:'updateProfile'});_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);toast.error('Unable to update profile',{id:'updateProfile'});case 10:case\"end\":return _context.stop();}}},_callee,null,[[1,7]]);}));return function updateUserProfile(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(ThemeProvider,{theme:darkTheme,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.info,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Profile\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Update your personal information.\"})]}),/*#__PURE__*/_jsx(Avatar,{}),/*#__PURE__*/_jsx(\"div\",{className:styles.card,children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:updateUserProfile,className:styles.form,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles['form-fields'],children:[/*#__PURE__*/_jsxs(\"div\",{className:styles['input-group'],children:[/*#__PURE__*/_jsx(Input,{type:\"text\",label:\"First name\",value:firstName,onChange:function onChange(e){return setFirstName(e.target.value);},required:true,disabled:updatingProfile}),/*#__PURE__*/_jsx(Input,{type:\"text\",label:\"Last name\",value:lastName,onChange:function onChange(e){return setLastName(e.target.value);},required:true,disabled:updatingProfile})]}),/*#__PURE__*/_jsx(\"div\",{className:styles['input-email-wrapper'],children:/*#__PURE__*/_jsx(Input,{type:\"email\",label:\"Email address\",value:user===null||user===void 0?void 0:user.email,readOnly:true,disabled:updatingProfile})})]}),/*#__PURE__*/_jsx(\"div\",{className:styles['form-footer'],children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!isProfileFormDirty||updatingProfile,className:styles.button,children:\"Update\"})})]})})]})})});};export default Profile;","map":{"version":3,"names":["styles","useState","useOutletContext","Input","gql","useMutation","toast","ThemeProvider","createTheme","Avatar","darkTheme","palette","mode","UPDATE_USER_MUTATION","Profile","user","metadata","firstName","setFirstName","lastName","setLastName","isFirstNameDirty","isLastNameDirty","isProfileFormDirty","mutateUser","updatingProfile","loading","updateUserProfile","e","preventDefault","variables","id","displayName","trim","success","error","container","info","card","form","target","value","email","button"],"sources":["C:/Users/Alias/weboldal/web-login/src/pages/Profile.js"],"sourcesContent":["import styles from '../styles/pages/Profile.module.css';\n\nimport { useState } from 'react';\n\nimport { useOutletContext } from 'react-router-dom';\nimport Input from '../components/Input';\n\nimport { gql, useMutation } from '@apollo/client'\nimport { toast } from 'react-hot-toast'\n\n\nimport { ThemeProvider, createTheme } from '@mui/material/styles';\n\nimport Avatar from '../components/Avatar';\n\nconst darkTheme = createTheme({\n  palette: {\n    mode: 'dark',\n  },\n});\n\n\nconst UPDATE_USER_MUTATION = gql`\n  mutation ($id: uuid!, $displayName: String!, $metadata: jsonb) {\n    updateUser(pk_columns: { id: $id }, _set: { displayName: $displayName, metadata: $metadata, avatarUrl: $avatarUrl }) {\n      id\n      displayName\n      metadata\n      avatarUrl\n    }\n  }\n`;\n\n\n\n\nconst Profile = () => {\n  const { user } = useOutletContext();\n\n  const [firstName, setFirstName] = useState(user?.metadata?.firstName ?? '');\n  const [lastName, setLastName] = useState(user?.metadata?.lastName ?? '');\n\n  const isFirstNameDirty = firstName !== user?.metadata?.firstName;\n  const isLastNameDirty = lastName !== user?.metadata?.lastName;\n  const isProfileFormDirty = isFirstNameDirty || isLastNameDirty;\n\n  const [mutateUser, { loading: updatingProfile }] =\n  useMutation(UPDATE_USER_MUTATION);\n\n  const updateUserProfile = async e => {\n    e.preventDefault();\n\n    try {\n      await mutateUser({\n        variables: {\n          id: user.id,\n          displayName: `${firstName} ${lastName}`.trim(),\n          metadata: {\n            firstName,\n            lastName,\n          },\n        },\n      });\n      toast.success('Updated successfully', { id: 'updateProfile' })\n    } catch (error) {\n      toast.error('Unable to update profile', { id: 'updateProfile' })\n    }\n  };\n\n  return (\n    <>\n    <ThemeProvider theme={darkTheme}>\n     \n\n      <div className={styles.container}>\n        <div className={styles.info}>\n          <h2>Profile</h2>\n          <p>Update your personal information.</p>\n        </div>\n\n        <Avatar/>\n\n        <div className={styles.card}>\n          <form onSubmit={updateUserProfile} className={styles.form}>\n            <div className={styles['form-fields']}>\n              <div className={styles['input-group']}>\n                <Input\n                  type=\"text\"\n                  label=\"First name\"\n                  value={firstName}\n                  onChange={e => setFirstName(e.target.value)}\n                  required\n                  disabled={updatingProfile}\n                />\n                <Input\n                  type=\"text\"\n                  label=\"Last name\"\n                  value={lastName}\n                  onChange={e => setLastName(e.target.value)}\n                  required\n                  disabled={updatingProfile}\n                />\n              </div>\n              <div className={styles['input-email-wrapper']}>\n                <Input\n                  type=\"email\"\n                  label=\"Email address\"\n                  value={user?.email}\n                  readOnly\n                  disabled={updatingProfile}\n                />\n              </div>\n            </div>\n\n            <div className={styles['form-footer']}>\n              <button\n                type=\"submit\"\n                disabled={!isProfileFormDirty || updatingProfile }\n                className={styles.button}\n              >\n                Update\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n      </ThemeProvider>\n    </>\n  );\n};\n\nexport default Profile;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}